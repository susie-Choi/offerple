# Implementation Plan

- [x] 1. CVE 데이터 소스 구현
  - CVEDataSource 클래스를 BaseDataSource를 상속하여 구현
  - NVD API 2.0 통합 및 세 가지 수집 방식 지원 (CVE ID, 키워드, CPE)
  - Rate limiting 및 API 키 처리 로직 구현
  - cutoff_date 기반 시간적 필터링 구현
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 6.1, 6.2, 6.3, 6.5_

- [x] 2. CVE 데이터 수집 스크립트 구현
  - collect_cve_data.py 스크립트 작성
  - YAML 설정 파일 로딩 구현
  - 명령줄 인자 파싱 (config, log-level, output)
  - CVE 타겟 목록 순회 및 데이터 수집
  - JSONL 형식으로 데이터 저장
  - 진행 상황 표시 (tqdm progress bar)
  - 수집 통계 및 다음 단계 안내 출력
  - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.6_

- [x] 3. Neo4j 그래프 로더 구현
  - CVEGraphLoader 클래스 구현
  - Neo4j Python driver 통합
  - Uniqueness constraints 생성 메서드 구현
  - CVE 노드 생성 및 속성 설정 (CVSS, 설명 등)
  - CWE 관계 생성 (HAS_WEAKNESS)
  - CPE 및 제품 관계 생성 (AFFECTS, PRODUCES, HAS_VERSION)
  - Reference 관계 생성 (HAS_REFERENCE)
  - MERGE 패턴으로 중복 방지
  - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7_

- [x] 4. Neo4j 로드 스크립트 구현
  - load_cve_to_neo4j.py 스크립트 작성
  - 명령줄 인자 파싱 (jsonl_file, uri, username, password, log-level)
  - JSONL 파일 읽기 및 파싱
  - CVEGraphLoader를 사용한 데이터 로드
  - 로드 진행 상황 로깅 (10개마다)
  - 로드 통계 출력
  - _Requirements: 5.4, 5.5, 5.6, 5.7_

- [x] 5. 설정 파일 작성
  - cve_config.yaml 예제 파일 작성
  - cutoff_date, output_dir, rate_limit 등 파라미터 정의
  - CVE 타겟 목록 정의 (Log4Shell 및 기타 유명 CVE)
  - 키워드 검색 예제 포함
  - API 키 설정 방법 주석으로 안내
  - _Requirements: 4.1, 4.2, 4.5_

- [x] 6. 의존성 업데이트
  - requirements.txt에 neo4j>=5.14.0 추가
  - pyproject.toml 확인 (기존 의존성과 호환)
  - _Requirements: 6.4_

- [ ] 7. 사용 가이드 문서 작성
  - docs/cve_neo4j_guide.md 파일 생성
  - Neo4j 설치 방법 안내 (Desktop, Docker)
  - NVD API 키 발급 방법 안내
  - CVE 데이터 수집 실행 예제
  - Neo4j 로드 실행 예제
  - 샘플 Cypher 쿼리 제공 (취약점 분석 예제)
  - 트러블슈팅 섹션 추가
  - _Requirements: 7.1, 7.2, 7.3, 7.4, 7.5_

- [ ] 8. 코드 문서화 개선
  - CVEDataSource 메서드에 상세한 docstring 추가
  - CVEGraphLoader 메서드에 상세한 docstring 추가
  - 복잡한 로직에 인라인 주석 추가
  - 타입 힌트 검증 및 보완
  - _Requirements: 7.6_

- [ ] 9. 단위 테스트 작성
  - tests/test_cve_datasource.py 생성
  - Mock NVD API 응답을 사용한 테스트
  - cutoff_date 필터링 테스트
  - Rate limit 처리 테스트
  - API 키 유무에 따른 동작 테스트
  - 에러 케이스 테스트 (CVE not found, network error)
  - _Requirements: Testing Strategy - Unit Testing_

- [ ] 10. 통합 테스트 작성
  - tests/test_cve_integration.py 생성
  - End-to-end 데이터 흐름 테스트
  - JSONL 파일 생성 검증
  - Neo4j 테스트 인스턴스 사용 (testcontainers 고려)
  - 데이터 무결성 검증 Cypher 쿼리
  - _Requirements: Testing Strategy - Integration Testing_

- [ ] 11. README 업데이트
  - README.md에 CVE-Neo4j 기능 섹션 추가
  - 설치 및 실행 방법 간단히 안내
  - docs/cve_neo4j_guide.md 링크 추가
  - _Requirements: 7.1, 7.2, 7.3_

- [ ] 12. Steering 문서 업데이트
  - .kiro/steering/tech.md에 Neo4j 관련 정보 추가
  - .kiro/steering/structure.md에 새로운 스크립트 및 설정 파일 추가
  - _Requirements: 7.6_
